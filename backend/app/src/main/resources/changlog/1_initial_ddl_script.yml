databaseChangeLog:
  - changeSet:
      id: initial-ddl-script
      author: Ashwani Kalra
      changes:
        - createTable:
            ifNotExists: true
            tableName: table_column_info
            columns:
              - column:
                  name: id
                  type: bigint
                  autoIncrement: true
                  constraints:
                    primaryKey: true
              - column:
                  name: table_name
                  type: VARCHAR(40)
                  constraints:
                    nullable: false
              - column:
                  name: column_name
                  type: VARCHAR(40)
                  constraints:
                    nullable: false
              - column:
                  name: header_name
                  type: VARCHAR(40)
              - column:
                  name: variable_name
                  type: VARCHAR(40)

        - addUniqueConstraint:
            constraintName: table_column_info_table_name_column_name_uk
            columnNames: table_name, column_name
            tableName: table_column_info

        - createTable:
            ifNotExists: true
            tableName: status
            columns:
              - column:
                  name: id
                  type: bigint
                  autoIncrement: true
                  constraints:
                    primaryKey: true
              - column:
                  name: code
                  type: VARCHAR(30)
                  constraints:
                    unique: true
                    nullable: false
              - column:
                  name: description
                  type: VARCHAR(130)
              - column:
                  name: type
                  type: VARCHAR(10)
              - column:
                  name: is_deleted
                  type: BOOLEAN
                  defaultValueBoolean: false

        - createTable:
            ifNotExists: true
            tableName: control
            columns:
              - column:
                  name: id
                  type: bigint
                  autoIncrement: true
                  constraints:
                    primaryKey: true
              - column:
                  name: file_name
                  type: VARCHAR(80)
                  constraints:
                    unique: true
                    nullable: false
              - column:
                  name: user_id
                  type: VARCHAR(30)
                  constraints:
                    nullable: false
              - column:
                  name: file_extracted_date
                  type: DATE
              - column:
                  name: batch_label_name
                  type: VARCHAR(30)
                  constraints:
                    nullable: false
              - column:
                  name: load_type_facility
                  type: BOOLEAN
                  defaultValueBoolean: false
              - column:
                  name: load_type_hds
                  type: BOOLEAN
                  defaultValueBoolean: false
              - column:
                  name: load_type_bus_org
                  type: BOOLEAN
                  defaultValueBoolean: false
              - column:
                  name: load_type_o_f_relationship
                  type: BOOLEAN
                  defaultValueBoolean: false
              - column:
                  name: load_type_o_o_relationship
                  type: BOOLEAN
                  defaultValueBoolean: false
              - column:
                  name: load_type_i_o_relationship
                  type: BOOLEAN
                  defaultValueBoolean: false
              - column:
                  name: load_type_wl_org_xref
                  type: BOOLEAN
                  defaultValueBoolean: false
              - column:
                  name: load_type_wl_prac_ident_xref
                  type: BOOLEAN
                  defaultValueBoolean: false
              - column:
                  name: process_start_date
                  type: TIMESTAMP(6)
                  defaultValueComputed: NOW()
              - column:
                  name: process_end_date
                  type: TIMESTAMP(6)
              - column:
                  name: status_code
                  type: VARCHAR(30)
              - column:
                  name: created_by
                  type: varchar(45)
                  defaultValueComputed: CURRENT_USER
              - column:
                  name: created_at
                  type: TIMESTAMPTZ
                  defaultValueComputed: NOW()
              - column:
                  name: updated_by
                  type: VARCHAR(45)
              - column:
                  name: updated_at
                  type: TIMESTAMPTZ

        - createTable:
            tableName: source_data
            ifNotExists: true
            columns:
              - column:
                  name: id
                  type: bigint
                  constraints:
                    primaryKey: true
                    autoIncrement: true
              - column:
                  name: control_id
                  type: bigint
                  constraints:
                    nullable: false
                    foreignKeyName: source_data_control_id_fk
                    referencedColumnNames: id
                    referencedTableName: control
              - column:
                  name: do_not_load
                  type: varchar(10)
              - column:
                  name: stakeholder
                  type: varchar(20)
              - column:
                  name: hds_ipc_id
                  type: varchar(19)
              - column:
                  name: hds_cpn_id
                  type: varchar(19)
              - column:
                  name: hds_provider_identifier1
                  type: varchar(50)
              - column:
                  name: hds_provider_identifier2
                  type: varchar(50)
              - column:
                  name: hds_provider_identifier3
                  type: varchar(50)
              - column:
                  name: hds_provider_identifier_type1
                  type: varchar(50)
              - column:
                  name: hds_provider_identifier_type2
                  type: varchar(50)
              - column:
                  name: hds_provider_identifier_type3
                  type: varchar(50)
              - column:
                  name: hds_hibc_facility_id
                  type: varchar(50)
              - column:
                  name: hds_type
                  type: varchar(50)
              - column:
                  name: hds_name
                  type: varchar(100)
              - column:
                  name: hds_name_alias
                  type: varchar(100)
              - column:
                  name: hds_preferred_name_flag
                  type: varchar(1)
              - column:
                  name: hds_email
                  type: varchar(50)
              - column:
                  name: hds_website
                  type: varchar(50)
              - column:
                  name: hds_bus_tel_area_code
                  type: varchar(30)
              - column:
                  name: hds_bus_tel_number
                  type: varchar(30)
              - column:
                  name: hds_tel_extension
                  type: varchar(30)
              - column:
                  name: hds_cell_area_code
                  type: varchar(30)
              - column:
                  name: hds_cell_number
                  type: varchar(30)
              - column:
                  name: hds_fax_area_code
                  type: varchar(30)
              - column:
                  name: hds_fax_number
                  type: varchar(30)
              - column:
                  name: hds_service_delivery_type
                  type: varchar(255)
              - column:
                  name: pcn_clinic_type
                  type: varchar(255)
              - column:
                  name: pcn_pci_flag
                  type: varchar(1)
              - column:
                  name: hds_hours_of_operation
                  type: varchar(255)
              - column:
                  name: hds_contact_name
                  type: varchar(255)
              - column:
                  name: hds_is_for_profit_flag
                  type: varchar(1)
              - column:
                  name: source_status
                  type: varchar(50)
              - column:
                  name: hds_parent_ipc_id
                  type: varchar(19)
              - column:
                  name: bus_ipc_id
                  type: varchar(19)
              - column:
                  name: bus_cpn_id
                  type: varchar(19)
              - column:
                  name: bus_name
                  type: varchar(100)
              - column:
                  name: bus_legal_name
                  type: varchar(255)
              - column:
                  name: bus_payee_number
                  type: varchar(255)
              - column:
                  name: bus_owner_name
                  type: varchar(255)
              - column:
                  name: bus_owner_type
                  type: varchar(255)
              - column:
                  name: bus_owner_type_other
                  type: varchar(255)
              - column:
                  name: fac_building_name
                  type: varchar(100)
              - column:
                  name: facility_hds_details_additional_info
                  type: varchar(255)
              - column:
                  name: physical_addr1
                  type: varchar(255)
              - column:
                  name: physical_addr2
                  type: varchar(255)
              - column:
                  name: physical_addr3
                  type: varchar(255)
              - column:
                  name: physical_addr4
                  type: varchar(255)
              - column:
                  name: physical_city
                  type: varchar(255)
              - column:
                  name: physical_province
                  type: varchar(255)
              - column:
                  name: physical_pcode
                  type: varchar(255)
              - column:
                  name: physical_country
                  type: varchar(255)
              - column:
                  name: phys_addr_is_private
                  type: varchar(1)
              - column:
                  name: mail_addr1
                  type: varchar(255)
              - column:
                  name: mail_addr2
                  type: varchar(255)
              - column:
                  name: mail_addr3
                  type: varchar(255)
              - column:
                  name: mail_addr4
                  type: varchar(255)
              - column:
                  name: mail_city
                  type: varchar(255)
              - column:
                  name: mail_bc
                  type: varchar(255)
              - column:
                  name: mail_pcode
                  type: varchar(255)
              - column:
                  name: mail_country
                  type: varchar(255)
              - column:
                  name: mail_addr_is_private
                  type: varchar(1)
              - column:
                  name: created_by
                  type: varchar(30)
                  defaultValue: CURRENT_USER
              - column:
                  name: created_at
                  type: TIMESTAMPTZ
                  defaultValue: NOW()
              - column:
                  name: updated_by
                  type: varchar(30)
              - column:
                  name: updated_at
                  type: TIMESTAMPTZ


        - createTable:
            tableName: process_data
            ifNotExists: true
            columns:
              - column:
                  name: id
                  type: bigint
                  constraints:
                    primaryKey: true
                    autoIncrement: true
              - column:
                  name: control_id
                  type: bigint
                  constraints:
                    nullable: false
                    foreignKeyName: process_data_control_id_fk
                    referencedColumnNames: id
                    referencedTableName: control
              - column:
                  name: do_not_load
                  type: VARCHAR(10)
              - column:
                  name: stakeholder
                  type: VARCHAR(20)
              - column:
                  name: hds_ipc_id
                  type: VARCHAR(19)
              - column:
                  name: hds_cpn_id
                  type: VARCHAR(19)
              - column:
                  name: hds_provider_identifier1
                  type: VARCHAR(50)
              - column:
                  name: hds_provider_identifier2
                  type: VARCHAR(50)
              - column:
                  name: hds_provider_identifier3
                  type: VARCHAR(50)
              - column:
                  name: hds_provider_identifier_type1
                  type: VARCHAR(50)
              - column:
                  name: hds_provider_identifier_type2
                  type: VARCHAR(50)
              - column:
                  name: hds_provider_identifier_type3
                  type: VARCHAR(50)
              - column:
                  name: hds_hibc_facility_id
                  type: VARCHAR(50)
              - column:
                  name: hds_type
                  type: VARCHAR(50)
              - column:
                  name: hds_name
                  type: VARCHAR(100)
              - column:
                  name: hds_name_alias
                  type: VARCHAR(100)
              - column:
                  name: hds_preferred_name_flag
                  type: VARCHAR(1)
              - column:
                  name: hds_email
                  type: VARCHAR(50)
              - column:
                  name: hds_website
                  type: VARCHAR(50)
              - column:
                  name: hds_bus_tel_area_code
                  type: VARCHAR(30)
              - column:
                  name: hds_bus_tel_number
                  type: VARCHAR(30)
              - column:
                  name: hds_tel_extension
                  type: VARCHAR(30)
              - column:
                  name: hds_cell_area_code
                  type: VARCHAR(30)
              - column:
                  name: hds_cell_number
                  type: VARCHAR(30)
              - column:
                  name: hds_fax_area_code
                  type: VARCHAR(30)
              - column:
                  name: hds_fax_number
                  type: VARCHAR(30)
              - column:
                  name: hds_service_delivery_type
                  type: VARCHAR(255)
              - column:
                  name: pcn_clinic_type
                  type: VARCHAR(255)
              - column:
                  name: pcn_pci_flag
                  type: VARCHAR(1)
              - column:
                  name: hds_hours_of_operation
                  type: VARCHAR(255)
              - column:
                  name: hds_contact_name
                  type: VARCHAR(255)
              - column:
                  name: hds_is_for_profit_flag
                  type: VARCHAR(1)
              - column:
                  name: source_status
                  type: VARCHAR(50)
              - column:
                  name: hds_parent_ipc_id
                  type: VARCHAR(19)
              - column:
                  name: bus_ipc_id
                  type: VARCHAR(19)
              - column:
                  name: bus_cpn_id
                  type: VARCHAR(19)
              - column:
                  name: bus_name
                  type: VARCHAR(100)
              - column:
                  name: bus_legal_name
                  type: VARCHAR(255)
              - column:
                  name: bus_payee_number
                  type: VARCHAR(255)
              - column:
                  name: bus_owner_name
                  type: VARCHAR(255)
              - column:
                  name: bus_owner_type
                  type: VARCHAR(255)
              - column:
                  name: bus_owner_type_other
                  type: VARCHAR(255)
              - column:
                  name: fac_building_name
                  type: VARCHAR(100)
              - column:
                  name: facility_hds_details_additional_info
                  type: VARCHAR(255)
              - column:
                  name: physical_addr1
                  type: VARCHAR(255)
              - column:
                  name: physical_addr2
                  type: VARCHAR(255)
              - column:
                  name: physical_addr3
                  type: VARCHAR(255)
              - column:
                  name: physical_addr4
                  type: VARCHAR(255)
              - column:
                  name: physical_city
                  type: VARCHAR(255)
              - column:
                  name: physical_province
                  type: VARCHAR(255)
              - column:
                  name: physical_pcode
                  type: VARCHAR(255)
              - column:
                  name: physical_country
                  type: VARCHAR(255)
              - column:
                  name: phys_addr_is_private
                  type: VARCHAR(1)
              - column:
                  name: mail_addr1
                  type: VARCHAR(255)
              - column:
                  name: mail_addr2
                  type: VARCHAR(255)
              - column:
                  name: mail_addr3
                  type: VARCHAR(255)
              - column:
                  name: mail_addr4
                  type: VARCHAR(255)
              - column:
                  name: mail_city
                  type: VARCHAR(255)
              - column:
                  name: mail_bc
                  type: VARCHAR(255)
              - column:
                  name: mail_pcode
                  type: VARCHAR(255)
              - column:
                  name: mail_country
                  type: VARCHAR(255)
              - column:
                  name: mail_addr_is_private
                  type: VARCHAR(1)
              - column:
                  name: facility_id
                  type: bigint
              - column:
                  name: rowstatus_code
                  type: VARCHAR(30)
                  constraints:
                    nullable: false
                    foreignKeyName: process_data_status_code_fk
                    referencedColumnNames: code
                    referencedTableName: status
              - column:
                  name: error_msg
                  type: VARCHAR(500)
              - column:
                  name: created_by
                  type: VARCHAR(30)
              - column:
                  name: created_at
                  type: TIMESTAMPTZ
              - column:
                  name: updated_by
                  type: VARCHAR(30)
              - column:
                  name: updated_at
                  type: TIMESTAMPTZ

        - createTable:
            tableName: message_detail
            ifNotExists: true
            columns:
              - column:
                  name: id
                  type: bigint
                  autoIncrement: true
                  constraints:
                    primaryKey: true
              - column:
                  name: process_data_id
                  type: bigint
                  constraints:
                    nullable: false
                    foreignKeyName: message_detail_process_data_id_fk
                    referencedColumnNames: id
                    referencedTableName: process_data
              - column:
                  name: rowstatus_code
                  type: VARCHAR(30)
              - column:
                  name: error_code
                  type: integer
              - column:
                  name: error_type
                  type: VARCHAR(40)
              - column:
                  name: error_msg
                  type: VARCHAR(130)

        - createTable:
            tableName: columns_display_preference
            ifNotExists: true
            columns:
              - column:
                  name: id
                  type: bigint
                  autoIncrement: true
                  constraints:
                    primaryKey: true
              - column:
                  name: user_id
                  type: VARCHAR(30)
                  constraints:
                    nullable: false
              - column:
                  name: view_name
                  type: VARCHAR(40)
                  constraints:
                    nullable: false
              - column:
                  name: display_columns
                  type: TEXT[]
              - column:
                  name: created_at
                  type: TIMESTAMPTZ
              - column:
                  name: created_by
                  type: VARCHAR(30)
              - column:
                  name: updated_by
                  type: VARCHAR(30)
              - column:
                  name: updated_at
                  type: TIMESTAMPTZ

        - addUniqueConstraint:
            ifNotExist: true
            constraintName: user_pref_unique
            columnNames: user_id, view_name
            tableName: columns_display_preference

        - createIndex:
            ifNotExist: true
            indexName: user_viewname_index
            tableName: columns_display_preference
            columns:
              - column:
                  name: user_id
              - column:
                  name: view_name
